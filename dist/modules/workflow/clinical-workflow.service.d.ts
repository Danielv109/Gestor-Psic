import { AppointmentsRepository } from '../appointments/appointments.repository';
import { SessionsRepository } from '../sessions/sessions.repository';
import { CryptoService } from '../../crypto/crypto.service';
import { AuditService } from '../audit/audit.service';
import { AppointmentStateMachine } from './appointment-state-machine';
import { AuthenticatedUser } from '../../common/interfaces/authenticated-user.interface';
import { ClinicalNarrative } from '../../crypto/interfaces/crypto.interfaces';
export declare class ClinicalWorkflowService {
    private readonly appointmentsRepo;
    private readonly sessionsRepo;
    private readonly cryptoService;
    private readonly auditService;
    private readonly stateMachine;
    private readonly logger;
    constructor(appointmentsRepo: AppointmentsRepository, sessionsRepo: SessionsRepository, cryptoService: CryptoService, auditService: AuditService, stateMachine: AppointmentStateMachine);
    confirmAppointment(appointmentId: string, actor: AuthenticatedUser): Promise<{
        id: string;
        patientId: string;
        therapistId: string;
        scheduledStart: Date;
        scheduledEnd: Date;
        status: import(".prisma/client").$Enums.AppointmentStatus;
        sessionType: import(".prisma/client").$Enums.SessionType;
        adminNotes: string | null;
        cancelledAt: Date | null;
        cancelReason: string | null;
        confirmedAt: Date | null;
        reminderSentAt: Date | null;
        deletedAt: Date | null;
        createdAt: Date;
        updatedAt: Date;
    }>;
    markNoShow(appointmentId: string, actor: AuthenticatedUser): Promise<{
        id: string;
        patientId: string;
        therapistId: string;
        scheduledStart: Date;
        scheduledEnd: Date;
        status: import(".prisma/client").$Enums.AppointmentStatus;
        sessionType: import(".prisma/client").$Enums.SessionType;
        adminNotes: string | null;
        cancelledAt: Date | null;
        cancelReason: string | null;
        confirmedAt: Date | null;
        reminderSentAt: Date | null;
        deletedAt: Date | null;
        createdAt: Date;
        updatedAt: Date;
    }>;
    cancelAppointment(appointmentId: string, reason: string, actor: AuthenticatedUser): Promise<{
        id: string;
        patientId: string;
        therapistId: string;
        scheduledStart: Date;
        scheduledEnd: Date;
        status: import(".prisma/client").$Enums.AppointmentStatus;
        sessionType: import(".prisma/client").$Enums.SessionType;
        adminNotes: string | null;
        cancelledAt: Date | null;
        cancelReason: string | null;
        confirmedAt: Date | null;
        reminderSentAt: Date | null;
        deletedAt: Date | null;
        createdAt: Date;
        updatedAt: Date;
    }>;
    startSession(appointmentId: string, actor: AuthenticatedUser, initialNarrative?: ClinicalNarrative): Promise<{
        session: {
            id: string;
            patientId: string;
            therapistId: string;
            deletedAt: Date | null;
            createdAt: Date;
            updatedAt: Date;
            appointmentId: string;
            startedAt: Date;
            endedAt: Date | null;
            durationMinutes: number | null;
            clinicalNarrativeEncrypted: Buffer | null;
            narrativeIV: Buffer | null;
            narrativeKeyId: string | null;
            signedAt: Date | null;
            signatureHash: string | null;
            isDraft: boolean;
            isLocked: boolean;
            legalStatus: import(".prisma/client").$Enums.SessionLegalStatus;
            amendedAt: Date | null;
            amendReason: string | null;
            amendedBy: string | null;
            voidedAt: Date | null;
            voidReason: string | null;
            safetyProtocol: string | null;
            voidedBy: string | null;
        };
        appointmentStatus: "IN_PROGRESS";
    }>;
    endSession(sessionId: string, narrative: ClinicalNarrative, actor: AuthenticatedUser): Promise<{
        session: {
            id: string;
            patientId: string;
            therapistId: string;
            deletedAt: Date | null;
            createdAt: Date;
            updatedAt: Date;
            appointmentId: string;
            startedAt: Date;
            endedAt: Date | null;
            durationMinutes: number | null;
            clinicalNarrativeEncrypted: Buffer | null;
            narrativeIV: Buffer | null;
            narrativeKeyId: string | null;
            signedAt: Date | null;
            signatureHash: string | null;
            isDraft: boolean;
            isLocked: boolean;
            legalStatus: import(".prisma/client").$Enums.SessionLegalStatus;
            amendedAt: Date | null;
            amendReason: string | null;
            amendedBy: string | null;
            voidedAt: Date | null;
            voidReason: string | null;
            safetyProtocol: string | null;
            voidedBy: string | null;
        };
        durationMinutes: number;
        appointmentStatus: "COMPLETED";
    }>;
    signSession(sessionId: string, signatureConfirmation: string, actor: AuthenticatedUser): Promise<{
        session: {
            id: string;
            patientId: string;
            therapistId: string;
            deletedAt: Date | null;
            createdAt: Date;
            updatedAt: Date;
            appointmentId: string;
            startedAt: Date;
            endedAt: Date | null;
            durationMinutes: number | null;
            clinicalNarrativeEncrypted: Buffer | null;
            narrativeIV: Buffer | null;
            narrativeKeyId: string | null;
            signedAt: Date | null;
            signatureHash: string | null;
            isDraft: boolean;
            isLocked: boolean;
            legalStatus: import(".prisma/client").$Enums.SessionLegalStatus;
            amendedAt: Date | null;
            amendReason: string | null;
            amendedBy: string | null;
            voidedAt: Date | null;
            voidReason: string | null;
            safetyProtocol: string | null;
            voidedBy: string | null;
        };
        signatureHash: string;
        isLocked: boolean;
    }>;
    getWorkflowStatus(appointmentId: string): Promise<{
        appointment: {
            id: string;
            status: import(".prisma/client").$Enums.AppointmentStatus;
            statusDescription: string;
            isFinal: boolean;
            availableTransitions: import(".prisma/client").$Enums.AppointmentStatus[];
            canCreateSession: boolean;
        };
        session: {
            id: string;
            startedAt: Date;
            endedAt: Date | null;
            durationMinutes: number | null;
            isDraft: boolean;
            isLocked: boolean;
            isSigned: boolean;
        } | null;
        workflow: {
            stage: string;
            nextAction: string | null;
        };
    }>;
    private getAppointmentOrFail;
    private getSessionOrFail;
    private auditStateChange;
    private emitWorkflowEvent;
    private determineWorkflowStage;
    private determineNextAction;
}
